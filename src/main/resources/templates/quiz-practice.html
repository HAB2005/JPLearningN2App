<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L√†m b√†i luy·ªán t·∫≠p - JLPT N2 Practice</title>
    <link rel="stylesheet" th:href="@{/css/dashboard.css}">
    <link rel="stylesheet" th:href="@{/css/quiz-practice.css}">
    <script th:replace="~{fragments/header :: header-script}"></script>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div th:replace="~{fragments/sidebar :: sidebar}"></div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div th:replace="~{fragments/header :: header}"></div>
            
            <!-- Quiz Practice Content -->
            <div class="content">
                <div class="quiz-practice-container">
                    <!-- Quiz Header -->
                    <div class="quiz-practice-header">
                        <button class="btn-back" onclick="goBack()">‚Üê Quay l·∫°i</button>
                        <div class="quiz-info">
                            <h2 id="quizTitle">ƒêang t·∫£i...</h2>
                            <div class="quiz-progress">
                                <span id="currentQuestion">0</span> / <span id="totalQuestions">0</span> c√¢u
                            </div>
                        </div>
                        <div class="header-actions">
                            <div id="timerDisplay" class="timer-display" style="display: none;">
                                <span class="timer-icon">‚è±Ô∏è</span>
                                <span id="timerText">00:00</span>
                            </div>
                            <button id="btnSubmitHeader" class="btn-submit-header" onclick="submitQuiz()" style="display: none;">
                                ‚úì N·ªôp b√†i
                            </button>
                            <button id="btnRetakeHeader" class="btn-retake-header" onclick="retakeQuiz()" style="display: none;">
                                üîÑ L√†m l·∫°i
                            </button>
                        </div>
                    </div>

                    <!-- Loading State -->
                    <div id="loadingState" class="loading-state">
                        <div class="spinner"></div>
                        <p>ƒêang t·∫£i c√¢u h·ªèi...</p>
                    </div>

                    <!-- Quiz Content -->
                    <div id="quizContent" class="quiz-content-wrapper" style="display: none;">
                        <div class="quiz-main">
                            <!-- Question Card -->
                            <div class="question-card">
                                <div class="question-number">C√¢u <span id="questionNumber">1</span></div>
                                <div class="question-text">
                                    <div class="word-display">
                                        <span id="questionWord" class="word"></span>
                                    </div>
                                    <p id="questionPrompt" class="prompt">Ch·ªçn nghƒ©a ƒë√∫ng:</p>
                                </div>
                            </div>

                            <!-- Options -->
                            <div id="optionsContainer" class="options-container">
                                <!-- Options will be dynamically inserted here -->
                            </div>

                            <!-- Navigation -->
                            <div class="quiz-navigation">
                                <button id="btnPrevious" class="btn-nav" onclick="previousQuestion()" disabled>
                                    ‚Üê C√¢u tr∆∞·ªõc
                                </button>
                                <button id="btnNext" class="btn-nav btn-primary" onclick="nextQuestion()">
                                    C√¢u ti·∫øp ‚Üí
                                </button>
                            </div>
                        </div>

                        <!-- Question Navigator Sidebar -->
                        <div class="question-navigator">
                            <div class="navigator-header">
                                <h3>Danh s√°ch c√¢u h·ªèi</h3>
                                <div class="navigator-legend">
                                    <div class="legend-item">
                                        <span class="legend-dot answered"></span>
                                        <span>ƒê√£ l√†m</span>
                                    </div>
                                    <div class="legend-item">
                                        <span class="legend-dot current"></span>
                                        <span>Hi·ªán t·∫°i</span>
                                    </div>
                                    <div class="legend-item">
                                        <span class="legend-dot unanswered"></span>
                                        <span>Ch∆∞a l√†m</span>
                                    </div>
                                </div>
                            </div>
                            <div id="questionGrid" class="question-grid">
                                <!-- Question buttons will be dynamically inserted here -->
                            </div>
                        </div>
                    </div>

                    <!-- Confirm Submit Modal -->
                    <div id="confirmModal" class="modal" style="display: none;">
                        <div class="modal-content">
                            <div class="modal-icon">‚ö†Ô∏è</div>
                            <h3 class="modal-title">X√°c nh·∫≠n n·ªôp b√†i</h3>
                            <p id="modalMessage" class="modal-message">B·∫°n c√≥ ch·∫Øc mu·ªën n·ªôp b√†i?</p>
                            <div class="modal-actions">
                                <button class="modal-btn modal-btn-cancel" onclick="closeModal()">H·ªßy</button>
                                <button class="modal-btn modal-btn-confirm" onclick="confirmSubmit()">N·ªôp b√†i</button>
                            </div>
                        </div>
                    </div>

                    <!-- Result Screen -->
                    <div id="resultScreen" class="result-screen" style="display: none;">
                        <div class="result-card">
                            <div id="resultIcon" class="result-icon">üéâ</div>
                            <h2>Ho√†n th√†nh!</h2>
                            <div class="result-score">
                                <div class="score-circle">
                                    <div class="score-percentage">
                                        <span id="scorePercentage">0</span><span class="percent-sign">%</span>
                                    </div>
                                </div>
                                <p class="score-text">
                                    B·∫°n ƒë√£ tr·∫£ l·ªùi ƒë√∫ng <span id="correctCount">0</span>/<span id="totalCount">0</span> c√¢u
                                </p>
                            </div>
                            <div class="result-actions">
                                <button class="btn-result" onclick="reviewAnswers()">üìù Xem l·∫°i ƒë√°p √°n</button>
                                <button class="btn-result btn-primary" onclick="retakeQuiz()">üîÑ L√†m l·∫°i</button>
                                <button class="btn-result" onclick="goBack()">‚Üê Quay l·∫°i</button>
                            </div>
                        </div>
                    </div>

                    <!-- Review Screen -->
                    <div id="reviewScreen" class="review-screen" style="display: none;">
                        <div class="review-content-wrapper">
                            <div class="review-main">
                                <div class="review-question-card">
                                    <div class="review-question-text">
                                        <div class="word-display">
                                            <span id="reviewQuestionWord" class="word"></span>
                                        </div>
                                        <p id="reviewQuestionPrompt" class="prompt">Ch·ªçn nghƒ©a ƒë√∫ng:</p>
                                    </div>
                                </div>

                                <div id="reviewOptionsContainer" class="review-options-container">
                                    <!-- Review options will be inserted here -->
                                </div>

                                <div class="review-navigation">
                                    <button id="btnReviewPrevious" class="btn-nav" onclick="previousReviewQuestion()" disabled>
                                        ‚Üê C√¢u tr∆∞·ªõc
                                    </button>
                                    <button id="btnReviewNext" class="btn-nav btn-primary" onclick="nextReviewQuestion()">
                                        C√¢u ti·∫øp ‚Üí
                                    </button>
                                </div>
                            </div>

                            <!-- Review Navigator Sidebar -->
                            <div class="review-navigator">
                                <div class="navigator-header">
                                    <h3>K·∫øt qu·∫£ chi ti·∫øt</h3>
                                    <div class="navigator-legend">
                                        <div class="legend-item">
                                            <span class="legend-dot correct"></span>
                                            <span>ƒê√∫ng</span>
                                        </div>
                                        <div class="legend-item">
                                            <span class="legend-dot wrong"></span>
                                            <span>Sai</span>
                                        </div>
                                        <div class="legend-item">
                                            <span class="legend-dot skipped"></span>
                                            <span>B·ªè qua</span>
                                        </div>
                                        <div class="legend-item">
                                            <span class="legend-dot current"></span>
                                            <span>Hi·ªán t·∫°i</span>
                                        </div>
                                    </div>
                                </div>
                                <div id="reviewGrid" class="question-grid">
                                    <!-- Review grid buttons will be dynamically inserted here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script th:src="@{/js/quiz-practice.js}"></script>
</body>
</html>
